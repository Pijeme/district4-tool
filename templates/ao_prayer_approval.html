{% extends "base.html" %}
{% block title %}Prayer Request Approval - District 4 Tool{% endblock %}

{% block content %}
<section class="card">
  <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:14px; flex-wrap:wrap;">
    <div>
      <h2 style="margin-bottom:6px;">Prayer Request Approval</h2>
      <p class="muted small" style="margin:0;">
        Review pending prayer requests. Approving will make them visible on the dashboard.
      </p>
    </div>

    <div style="display:flex; gap:10px; flex-wrap:wrap;">
      <a href="{{ url_for('ao_tool') }}" class="btn-secondary">← Back to AO Tool</a>
    </div>
  </div>

  {% if pending and pending|length > 0 %}
    <div style="margin-top:12px;">
      {% for r in pending %}
        <div class="card" style="margin-top:12px; border:2px solid #111;">
          <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:10px; flex-wrap:wrap;">
            <div>
              <div style="font-weight:900;">{{ r.title }}</div>
              <div class="muted small">
                {{ r.request_date }}
                {% if r.church_name %} • {{ r.church_name }}{% endif %}
                {% if r.submitted_by %} • Submitted by: {{ r.submitted_by }}{% endif %}
              </div>
            </div>
            <span style="padding:6px 10px; border-radius:999px; border:1px solid #9a7b00; background:#fff4cc; font-weight:800; font-size:12px;">Pending</span>
          </div>

          <div class="small" style="margin-top:10px; white-space:pre-wrap;">{{ r.request_text }}</div>

          <form method="POST" action="/ao-tool/prayer-requests/approve" style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
            <input type="hidden" name="request_id" value="{{ r.request_id }}">
            <button class="btn-primary" type="submit">Approve</button>

            <button class="btn-secondary" type="submit" formaction="/ao-tool/prayer-requests/reject"
                    onclick="return confirm('Reject this prayer request?')">
              Reject
            </button>
          </form>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="card" style="margin-top:12px;">
      <div class="muted">No pending prayer requests.</div>
    </div>
  {% endif %}
</section>
{% endblock %}
